rule Hunting_exploit_logs_2 {
    meta:
        author = "@captainGeech42"
        description = "Look for log related strings in exploit code (v2), inspired by @stvemillertime"
        date = "2024-01-19"
        version = "1"
        DaysofYARA = "18/100"
    strings:
        $s1 = "[*]" ascii wide
        $s2 = "[+]" ascii wide
        $s3 = "[!]" ascii wide
        $s4 = "[-]" ascii wide
        $s5 = "[^]" ascii wide
        $s6 = "[~]" ascii wide

        $fp1 = "wextract.pdb" fullword
        $fp2 = "WdfCoInstaller01009.pdb" fullword
        $fp3 = "advapi32.pdb" fullword
        $fp4 = "dxmrtp.pdb" fullword
        $fp5 = "Win32 Cabinet Self-Extractor"
        $fp6 = "gccustomhook.pdb" fullword
        $fp7 = "libiconv: character set conversion library" wide
        $fp8 = "RecoveryDrive.pdb" fullword
        $fp9 = "C:\\builds\\RIBS\\"
        $fp10 = "AUCFlashSpriteRegister_IMoaRegister"
        $fp11 = "sfxcab.pdb" fullword
        $fp12 = "A:C:D:R:I:L::F::Z::N:X::P:MS:Vh::o::p:s:d:j:i:fbvm:nlt:xy"
        $fp13 = "Usage: 7za <command>"
        $fp14 = "D3DCompiler_42.pdb" fullword
        $fp15 = "Introversion Software Defcon" wide
    condition:
        filesize < 2MB and
        (
            (uint16(0) == 0x5a4d and uint32(uint32(0x3c)) == 0x00004550) or
            uint32(0) == 0x464c457f or
            uint32(0) == 0xfeedface or // Mach-O MH_MAGIC
            uint32(0) == 0xcefaedfe or // Mach-O MH_CIGAM
            uint32(0) == 0xfeedfacf or // Mach-O MH_MAGIC_64
            uint32(0) == 0xcffaedfe or // Mach-O MH_CIGAM_64
            uint32(0) == 0xcafebabe or // Mach-O FAT_MAGIC
            uint32(0) == 0xbebafeca    // Mach-O FAT_CIGAM
        ) and
        2 of ($s*) and
        (#s1+#s2+#s3+#s4+#s5+#s6) > 2 and
        none of ($fp*)
}