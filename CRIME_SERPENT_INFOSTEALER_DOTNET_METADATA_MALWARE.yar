import "dotnet"
rule CRIME_SERPENT_INFOSTEALER_DOTNET_METADATA_MALWARE {
	meta:
		version = "1"
		date = "1/18/24"
		modified = "1/18/24"
		status = "RELEASED"
		sharing = "TLP:CLEAR"
		source = "n/a"
		author = "@x0rc1sm"
		description = ""
		category = "malware"
		malware_type = "INFOSTEALER"
		malware_family = "SERPENT"
		mitre_att = "TA0002, TA0005, TA0006, TA0007, TA0009, TA0011"
		actor_type = "CRIME"
		actor = "UNK"
		report = "https://labs.k7computing.com/index.php/uncovering-the-serpent/"
		hash = "e97868c8431ccd922dea3dfb50f7e0b5"
		hash = "7ec3f0f2aa8dee96f0df30c9e8e529a3578ff8d8"
		hash = "cd118e082d2c035da179358c8a3c54b879b6e1b71eec2a965b78aa929b83eb11"
    strings:
        $pdb1 = "/home/pluto/Downloads/SerpentStealer/Serpent/obj/Release/net7.0/win-x64/Serpent.pdb"
    condition:
    	uint16(0) == 0x5a4d and (dotnet.guids[0]== "7e8abd91-7b70-4ee7-8184-ea4b00adafdc" or dotnet.assembly.name == "Serpent" or $pdb1) 
}
