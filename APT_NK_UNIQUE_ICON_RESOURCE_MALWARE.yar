import "pe"
import "hash"
rule APT_NK_UNIQUE_ICON_RESOURCE_MALWARE {
	meta:
		version = "1"
		date = "1/22/24"
		modified = "1/22/24"
		status = "RELEASED"
		sharing = "TLP:CLEAR"
		source = "n/a"
		author = "@x0rc1sm"
		description = "PDF Icon used for malware, looking to see if Icon resource seen elsewhere"
		category = "malware"
		malware_type = "BACKDOOR"
		malware_family = "UNKNOWN"
		mitre_att = "TA0002, TA0003, TA0004, TA0005, TA0007, TA0011"
		actor_type = "APT"
		actor = "Lazarus"
		report = "https://www.rewterz.com/rewterz-news/rewterz-threat-alert-lazarus-apt-group-active-iocs-26/"
		hash = "8df7777ac7315c5e256ce35ea36cc73f"
		hash = "7d09178e4702790ec370e50b973528aec5bf0e3a"
		hash = "e5466b99c1af9fe3fefdd4da1e798786a821c6d853a320d16cc10c06bc6f3fc5"
	condition:
		uint16(0) == 0x5a4d and for any i in (0..pe.number_of_resources -1):(hash.md5(pe.resources[i].offset,pe.resources[i].length)=="de2c09ea6c0eeeecc88c0585f454b391")
}
