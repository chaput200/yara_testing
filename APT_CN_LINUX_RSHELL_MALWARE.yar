//11f21d08f819dea21a09c602a4391142a5648f3e17a07a24d41418fcc17ea83f	TELF = T110044B03FB8594FBC0C9D5B2C6CFC0AADA6270546325152B3DCEA3151919B318F6EBA7
//43ae4e624413a587667027c03416d78b2515ac9081b8c9c967aadb1157f49e55	TELF = T110044B03FB8594FBC0C9D5B2C6CFC0AADA6270546325152B3DCEA3151919B318F6EBA7
//1400b65d7200adf2b15be4531dac25bfe6b79391b686da33a0ffd67b5eefcc4e	TELF = T110044B03FB8594FBC0C9D5B2C6CFC0AADA6270546325152B3DCEA3151919B318F6EBA7
//2ada1b48457c169cf3f80e248190374102615e2c89b70e574fba4ddc09b5fcd5	TELF = T1AE244907FB4554BEC0DAC6B2C7DFC1AADE2530886335912A7CCEA6101925B309F6E767
//c65c435737ac02132d9dfeb6ec1d7d903648f61ecdda8a85b4250f064cb4673f	TELF = T193F47C03FBD164BEC4D5D970C78FE026DFB5B0486122617B79CA6A006E56A30AF1F693
//08dd5a9fdc387855fb5a23c167abec63b22272f66de099155036c5ce7e4deeb8	TELF = T1D4D2D937F7A2C774D0D9A3701DDB4861F5B3B0F06732221B260656776A82B881F1FA5A
//d0fec5c5e2687e76af07a4a3c6e2e2b02789838c0b802f5041443ab482bc3498	TELF = T1D1154C03F7A894FAD4E9C8704B8FC5B3DC217C484276257F3A96A6012A7AE215F1DB71
//07aa739fa4942cfd68d4a075568456797f11ae34db5cd56f88d80185bc1d7a29	TELF = T1FF155C03F7A894FAD4E9C8704B8FC5B3DC217C484276257F3A96A6012A7AE215F1DB71
//d67aebfafa347a21805dbded3fa310e2268a5d2255fcb7f1c8004502a95e7538	TELF = T1436423D4852AB1F2F3E0C777BB5A1829BDD64B0532C017F46CE1AD940A3AA6A0544DCF
//e909c4dac832e9d1ecd1673c5bff6e1939d9c832a2509cb64931e4aa1e334077	TELF = T1DC154B03B7A894FAD4EAC4704B8FC5B3DC217C484276257F3A96A6012A7AE315F1DB71
//c10a3a78cdf1e48189ac270767f7f718bd15a9d4e48e580a9ef6ceff5f4abf46	TELF = T1616423C4726461DAFD2A69BB1A2283DC7545E3168BD1E1EE46874063AF4CC7263C32DF
//8019b7deaf41b48c38b8b48e016f208a28e0909d437d4e35e3e35f7995758564	TELF = T181154B03B7A894FAD4EAC4704B8FC5B3DC217C484276257F3A96A6012A7AE315F1DB71

import "magic"
import "elf"
rule APT_CN_LINUX_RSHELL_MALWARE {
	meta:
		version = "1"
		date = "1/7/24"
		modified = "1/7/24"
		status = "RELEASED"
		sharing = "TLP:CLEAR"
		source = "n/a"
		author = "@x0rc1sm"
		description = "Linux Malware Pivot with TELF hashes"
		category = "malware"
		malware_type = "BACKDOOR"
		malware_family = "RSHELL/SYSUPDATE"
		mitre_att = "TA0002,TA0003,TA0004,TA0005,TA0006,TA0007,TA0011"
		actor_type = "APT"
		actor = "LuckyMouse/EmissaryPanda/APT27/BronzeUnion/IronTiger"
		report = "https://www.trendmicro.com/en_ph/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html, https://www.trendmicro.com/en_ph/research/22/h/irontiger-compromises-chat-app-Mimi-targets-windows-mac-linux-users.html, "
		hash = "a4f702e862fff5b71cb0941f39843437"
		hash = "5afb47de3a6deae177193f8e79db9a04da8de3cb"
		hash = "11f21d08f819dea21a09c602a4391142a5648f3e17a07a24d41418fcc17ea83f"
	condition:
		(magic.type() contains "ELF" or uint32(0) == 0x464c457f) and 
		(
		elf.telfhash() == "t110044b03fb8594fbc0c9d5b2c6cfc0aada6270546325152b3dcea3151919b318f6eba7" or
		elf.telfhash() == "t1ae244907fb4554bec0dac6b2c7dfc1aade2530886335912a7ccea6101925b309f6e767" or
		elf.telfhash() == "t193f47c03fbd164bec4d5d970c78fe026dfb5b0486122617b79ca6a006e56a30af1f693" or
		elf.telfhash() == "t1d4d2d937f7a2c774d0d9a3701ddb4861f5b3b0f06732221b260656776a82b881f1fa5a" or
		elf.telfhash() == "t1d1154c03f7a894fad4e9c8704b8fc5b3dc217c484276257f3a96a6012a7ae215f1db71" or
		elf.telfhash() == "t1ff155c03f7a894fad4e9c8704b8fc5b3dc217c484276257f3a96a6012a7ae215f1db71" or
		elf.telfhash() == "t1436423d4852ab1f2f3e0c777bb5a1829bdd64b0532c017f46ce1ad940a3aa6a0544dcf" or
		elf.telfhash() == "t1dc154b03b7a894fad4eac4704b8fc5b3dc217c484276257f3a96a6012a7ae315f1db71" or
		elf.telfhash() == "t1616423c4726461dafd2a69bb1a2283dc7545e3168bd1e1ee46874063af4cc7263c32df" or
		elf.telfhash() == "t181154b03b7a894fad4eac4704b8fc5b3dc217c484276257f3a96a6012a7ae315f1db71"
		)
}
