rule Hunting_exploit_shellcode_1 {
    meta:
        author = "@captainGeech42"
        description = "Look for exploit-related files pertaining to shellcode"
        date = "2024-01-16"
        version = "1"
        DaysofYARA = "16/100"
    strings:
        $s1 = "payload"
        $s2 = "shellcode"
        $p1 = /(\\x[0-9a-f]{2}){5,}/

        $fp1 = "html" nocase
        $fp2 = "part of the Metasploit Framework"
    condition:
        filesize < 100KB and
        uint32be(0) != 0x6465780a and
        uint16be(0) != 0x4d5a and
        uint16be(0) != 0x504b and
        uint32(0) != 0x5 and
        not $fp1 in (0..300) and
        none of ($fp*) and
        any of ($s*) and $p1
}